@page
@model Metrics.Web.Pages.Submissions.IndexModel

@using Metrics.Application.Authorization
@using Microsoft.AspNetCore.Authorization
@inject IAuthorizationService AuthorizationService

@{
    ViewData["Title"] = "Submissions";
    var canSubmitKpiScore = await AuthorizationService.AuthorizeAsync(
        User, ApplicationPolicies.CanSubmit_KpiScore_Policy);

    AuthorizationResult? canSubmitKeyKpiScore = await AuthorizationService.AuthorizeAsync(
        User, ApplicationPolicies.CanSubmit_KeyKpiScore_Policy);

    var canSubmitFeedbackScore = await AuthorizationService.AuthorizeAsync(
        User, ApplicationPolicies.CanSubmit_FeedbackScore_Policy);
}

<div class="sectionTitle">
    <div class="d-flex align-items-center">
        <h4 class="flex-grow-1">Submissions
        </h4>
        <span class="justify-content-end gap-2"></span>
    </div>
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a asp-page="/Index">Home</a></li>
            <li class="breadcrumb-item active">Submissions</li>
        </ol>
    </nav>
</div>


<div class="container">
    <div class="row mb-4 align-items-stretch">
        @if(canSubmitKpiScore.Succeeded) {
            <div class="d-flex col-xs-12 col-md-12 col-lg-4 mb-3">
                <div class="card w-100 department-score">
                    <div class="card-header">
                        <strong>Department Score</strong>
                    </div>
                    <div class="card-body d-flex flex-column">
                        <p class="card-text">Submit department performance scores</p>
                        <div class="mt-auto text-end">
                            <a asp-page="./DepartmentScores/Index" 
                                class="btn btn-secondary">
                                    <i class="bi bi-ui-checks"></i> Submissions</a>
                        </div>
                    </div>
                </div>
            </div>
        }

        @if(canSubmitKeyKpiScore.Succeeded) {
            <div class="d-flex col-xs-12 col-md-12 col-lg-4 mb-3">
                <div class="card w-100 department-metric-score">
                    <div class="card-header">
                        <strong>Department Metric Score (KEY)</strong>
                    </div>
                    <div class="card-body d-flex flex-column">
                        <p class="card-text">Submit department performance metric scores by metrics</p>
                        <div class="mt-auto text-end">
                            <a asp-page="./DepartmentMetricScores/Index" 
                                class="btn btn-secondary">
                                    <i class="bi bi-ui-checks"></i> Submissions</a>
                        </div>
                    </div>
                </div>
            </div>
        }

        @if(canSubmitFeedbackScore.Succeeded) {
            <div class="d-flex col-xs-12 col-md-12 col-lg-4 mb-3">
                <div class="card w-100 department-case-feedback-score">
                    <div class="card-header">
                        <strong>Department Case Feedback Scores</strong>
                    </div>
                    <div class="card-body d-flex flex-column">
                        <p class="card-text">Submit department case feedback scores</p>
                        <div class="mt-auto text-end">
                            <a asp-page="./DepartmentCaseFeedbackScores/Index" 
                                class="btn btn-secondary">
                                    <i class="bi bi-ui-checks"></i> Submissions</a>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>

@* =================FEEDBACK================================================= *@
    @* <div class="row mb-4 align-items-stretch">
        @if(isCaseFeedbackScoreSubmitter) {
            <div class="d-flex col-xs-12 col-md-12 col-lg-4">
                <div class="card w-100 department-case-feedback">
                    <div class="card-header">
                        <strong>Department Case Feedback</strong>
                    </div>
                    <div class="card-body d-flex flex-column">
                        <p class="card-text">Submit department case feedback</p>
                        <div class="mt-auto text-end">
                            <a asp-page="./DepartmentCaseFeedback/Index" 
                                class="btn btn-secondary">
                                    <i class="bi bi-ui-checks"></i> Feedback</a>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div> *@
</div>


@section Styles {
    <style>
        .department-score .card-header {
            color: var(--metric-green-color);
        }
        .department-score .card-body .btn {
            background: var(--metric-green-color);
            border: 0;
        }
        .department-score .card-body .btn:hover {
            background: var(--metric-deepgreen-color);
            border: 0;
        }
        
        .department-metric-score .card-header {
            color: var(--metric-blue-color);
        }
        .department-metric-score .card-body .btn {
            background: var(--metric-blue-color);
            border: 0;
        }
        .department-metric-score .card-body .btn:hover {
            background: var(--metric-deepblue-color);
            border: 0;
        }
        
        .department-case-feedback-score .card-header {
            color: var(--metric-red-color);
        }
        .department-case-feedback-score .card-body .btn {
            background: var(--metric-red-color);
            border: 0;
        }
        .department-case-feedback-score .card-body .btn:hover {
            background: var(--metric-deepred-color);
            border: 0;
        }
    </style>
}